<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.43">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Animacel (AniCura Korneuburg)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="anicura_data_en_files/libs/clipboard/clipboard.min.js"></script>
<script src="anicura_data_en_files/libs/quarto-html/quarto.js"></script>
<script src="anicura_data_en_files/libs/quarto-html/popper.min.js"></script>
<script src="anicura_data_en_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="anicura_data_en_files/libs/quarto-html/anchor.min.js"></script>
<link href="anicura_data_en_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="anicura_data_en_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="anicura_data_en_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="anicura_data_en_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="anicura_data_en_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Animacel (AniCura Korneuburg)</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="time-intervals-between-therapies" class="level2">
<h2 class="anchored" data-anchor-id="time-intervals-between-therapies">Time intervals between therapies</h2>
<section id="what-is-the-average-time-between-the-first-and-the-second-therapy-application-among-patients" class="level3">
<h3 class="anchored" data-anchor-id="what-is-the-average-time-between-the-first-and-the-second-therapy-application-among-patients">What is the average time between the first and the second therapy application among patients?</h3>
<div id="f349ae1d-2d77-455d-b3bd-e1f884939d66" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Data preparation</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Before the analysis some values were removed by hand. Some "?"'s were removed and incomplete dates were removed</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. treatment of 'First application date'</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.read_excel(<span class="st">"Tk Korneuburg_Stammzellpatienten_09102024_anon_en.xlsx"</span>)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>data[<span class="st">'Sample collection date'</span>] <span class="op">=</span> pd.to_datetime(data[<span class="st">'Sampling'</span>], errors<span class="op">=</span><span class="st">'coerce'</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>imputed_days_value <span class="op">=</span> <span class="dv">22</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert imputed_days_value to a timedelta</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>timedelta_value <span class="op">=</span>pd.to_timedelta(imputed_days_value, unit<span class="op">=</span><span class="st">'D'</span>)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>data[<span class="st">'first_application_data_cleaned'</span>] <span class="op">=</span> np.nan</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>data[<span class="st">'first_application_data_cleaned'</span>] <span class="op">=</span> data[<span class="st">'Sample collection date'</span>] <span class="op">+</span> timedelta_value</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>C:\Users\justb\AppData\Local\Temp\ipykernel_26176\2111960275.py:12: UserWarning: Parsing dates in %d.%m.%Y format when dayfirst=False (the default) was specified. Pass `dayfirst=True` or specify a format to silence this warning.
  data['Sample collection date'] = pd.to_datetime(data['Sampling'], errors='coerce')</code></pre>
</div>
</div>
<div id="d00789de-e881-465a-a426-be983839f393" class="cell" data-scrolled="true" data-execution_count="2">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove dates where second application date happened before first application date.</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>data[<span class="st">'Second application date'</span>] <span class="op">=</span> pd.to_datetime(data[<span class="st">"2nd_treatment"</span>], errors<span class="op">=</span><span class="st">'coerce'</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>data.loc[data[<span class="st">'Second application date'</span>]<span class="op">&lt;=</span>data[<span class="st">'first_application_data_cleaned'</span>],<span class="st">'Second application date'</span>] <span class="op">=</span> <span class="va">None</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>data[<span class="st">"age_at_first_appliction"</span>] <span class="op">=</span> (data[<span class="st">'first_application_data_cleaned'</span>].dt.year <span class="op">-</span> data[<span class="st">"Year of birth"</span>])</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>data[<span class="st">"age_at_first_appliction_str"</span>] <span class="op">=</span> data[<span class="st">"age_at_first_appliction"</span>].astype(<span class="bu">str</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>data[<span class="st">"age_at_first_appliction_str"</span>] <span class="op">=</span> data[<span class="st">"age_at_first_appliction_str"</span>].<span class="bu">str</span>.replace(<span class="st">".0"</span>, <span class="st">""</span>)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create age groups:</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Age groups</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co"># od 0 do 2 let,</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co"># od 2 do 6 let,</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="co"># od 6 do 10 let,</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="co"># več kot 10 let.</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>data.loc[data[<span class="st">"age_at_first_appliction"</span>].astype(<span class="bu">bool</span>),<span class="st">"age_group"</span>] <span class="op">=</span> <span class="st">"from 0 to 2"</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>data.loc[<span class="dv">2</span> <span class="op">&lt;</span> data[<span class="st">"age_at_first_appliction"</span>],<span class="st">"age_group"</span>] <span class="op">=</span> <span class="st">"from 2 to 6"</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>data.loc[<span class="dv">6</span> <span class="op">&lt;</span> data[<span class="st">"age_at_first_appliction"</span>],<span class="st">"age_group"</span>] <span class="op">=</span> <span class="st">"from 6 to 10"</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>data.loc[<span class="dv">10</span> <span class="op">&lt;</span> data[<span class="st">"age_at_first_appliction"</span>],<span class="st">"age_group"</span>] <span class="op">=</span> <span class="st">"more than 10"</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>data.loc[data[<span class="st">"age_at_first_appliction"</span>].isnull(),<span class="st">"age_group"</span>] <span class="op">=</span> <span class="st">"unkown"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="19f0da2c-2153-40d5-8dee-8923770f3b08" class="cell" data-execution_count="3">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> github_repo <span class="im">import</span> analysis_of_indications</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalize indications.</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>data[<span class="st">'Indication_list'</span>] <span class="op">=</span> data[<span class="st">'Diagnosis'</span>].<span class="bu">apply</span>(analysis_of_indications.normalize_text)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="8cd09075-c2c8-4fd9-8ed0-593a6aa16945" class="cell" data-execution_count="4">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Preparte nr of joints 1st</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>data[<span class="st">"Nr_joints treated_1_cleaned"</span>] <span class="op">=</span> data[<span class="st">"Number of joints treated"</span>].astype(<span class="bu">str</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>data[<span class="st">"Nr_joints treated_1_cleaned"</span>]<span class="op">=</span>data[<span class="st">"Nr_joints treated_1_cleaned"</span>].<span class="bu">str</span>.replace(<span class="vs">r"\?"</span>, <span class="st">""</span>, regex<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>data.loc[data[<span class="st">"Nr_joints treated_1_cleaned"</span>].<span class="bu">str</span>.contains(<span class="vs">r"[A-Za-z]"</span>, regex<span class="op">=</span><span class="va">True</span>), <span class="st">"Nr_joints treated_1_cleaned"</span>] <span class="op">=</span> np.nan</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>data.loc[data[<span class="st">"Nr_joints treated_1_cleaned"</span>] <span class="op">==</span> <span class="st">""</span>, <span class="st">"Nr_joints treated_1_cleaned"</span>] <span class="op">=</span> np.nan</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>data.loc[data[<span class="st">"Nr_joints treated_1_cleaned"</span>] <span class="op">==</span> <span class="st">" "</span>, <span class="st">"Nr_joints treated_1_cleaned"</span>] <span class="op">=</span> np.nan</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>data.loc[<span class="op">~</span>data[<span class="st">"Nr_joints treated_1_cleaned"</span>].isnull(), <span class="st">"Nr_joints treated_1_cleaned"</span>]<span class="op">=</span>data.loc[<span class="op">~</span>data[<span class="st">"Nr_joints treated_1_cleaned"</span>].isnull(), <span class="st">"Nr_joints treated_1_cleaned"</span>].astype(<span class="bu">float</span>).astype(<span class="bu">int</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="10317e1f-4e59-4b6d-9d68-1142f0223632" class="cell" data-execution_count="5">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Preparte nr of joints 2nd</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>data[<span class="st">"Nr_joints treated_2_cleaned"</span>] <span class="op">=</span> data[<span class="st">"2nd_joints"</span>].astype(<span class="bu">str</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>data[<span class="st">"Nr_joints treated_2_cleaned"</span>]<span class="op">=</span>data[<span class="st">"Nr_joints treated_2_cleaned"</span>].<span class="bu">str</span>.extract(<span class="vs">r'(\d+)'</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>data.loc[data[<span class="st">"Nr_joints treated_2_cleaned"</span>].<span class="bu">str</span>.contains(<span class="vs">r"[A-Za-z]"</span>, regex<span class="op">=</span><span class="va">True</span>, na<span class="op">=</span><span class="va">False</span>), <span class="st">"Nr_joints treated_2_cleaned"</span>] <span class="op">=</span> np.nan</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>data.loc[data[<span class="st">"Nr_joints treated_2_cleaned"</span>] <span class="op">==</span> <span class="st">""</span>, <span class="st">"Nr_joints treated_2_cleaned"</span>] <span class="op">=</span> np.nan</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>data.loc[data[<span class="st">"Nr_joints treated_2_cleaned"</span>] <span class="op">==</span> <span class="st">" "</span>, <span class="st">"Nr_joints treated_2_cleaned"</span>] <span class="op">=</span> np.nan</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>data.loc[<span class="op">~</span>data[<span class="st">"Nr_joints treated_2_cleaned"</span>].isnull(), <span class="st">"Nr_joints treated_2_cleaned"</span>]<span class="op">=</span>data.loc[<span class="op">~</span>data[<span class="st">"Nr_joints treated_2_cleaned"</span>].isnull(), <span class="st">"Nr_joints treated_2_cleaned"</span>].astype(<span class="bu">float</span>).astype(<span class="bu">int</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="fc773d0d-0bd6-4b96-a38f-041d8cfbf04e" class="cell" data-execution_count="6">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Analyste dates between 1st and 2nd treatment.</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>data_with_dates <span class="op">=</span> data[<span class="op">~</span>data[<span class="st">'first_application_data_cleaned'</span>].isnull()]</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>data_with_2nd_dates <span class="op">=</span> data_with_dates[<span class="op">~</span>data_with_dates[<span class="st">'Second application date'</span>].isnull()]</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Get days differemce to int.</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>data_with_2nd_dates <span class="op">=</span> data_with_2nd_dates[data_with_2nd_dates[<span class="st">'Second application date'</span>]<span class="op">&gt;</span>data_with_2nd_dates[<span class="st">'first_application_data_cleaned'</span>]]</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>data_with_2nd_dates[<span class="st">"1st-2nd-treatment_days"</span>] <span class="op">=</span> (data_with_2nd_dates[<span class="st">'Second application date'</span>]<span class="op">-</span>data_with_2nd_dates[<span class="st">'first_application_data_cleaned'</span>]).dt.days</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co"># print(f"Wrong dates {sum(data_with_2nd_dates['Second application date']&lt;data_with_2nd_dates['Sample collection date'])}")</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>data_with_2nd_dates[<span class="st">"1st-2nd-treatment_months"</span>] <span class="op">=</span> data_with_2nd_dates[<span class="st">"1st-2nd-treatment_days"</span>]<span class="op">/</span><span class="dv">30</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Among the patients, there are 36 with at least two treatments. The distribution of days between the second and first application is shown in the image <a href="#fig-second-first-dist" class="quarto-xref">Figure&nbsp;1</a>. The median number of days is 494, and the average is 660 days.</p>
<div id="c3590d93-97e4-47d2-a983-329ff392d417" class="cell" data-execution_count="7">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"The number of patients with two treatments is </span><span class="sc">{</span><span class="bu">len</span>(data_with_2nd_dates[<span class="st">'1st-2nd-treatment_days'</span>])<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"The number of patients who returned before the 500th day is </span><span class="sc">{</span><span class="bu">sum</span>(data_with_2nd_dates[<span class="st">"1st-2nd-treatment_days"</span>]<span class="op">&lt;</span><span class="dv">501</span>)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Median values of treatments is </span><span class="sc">{</span>data_with_2nd_dates[<span class="st">"1st-2nd-treatment_days"</span>]<span class="sc">.</span>median()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mean values of treatments is </span><span class="sc">{</span>data_with_2nd_dates[<span class="st">"1st-2nd-treatment_days"</span>]<span class="sc">.</span>mean()<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>The number of patients with two treatments 36
The number of patients who returned before the 500th day 19
Median values of treatments is 494.0
Mean values of treatments is 660.8333333333334</code></pre>
</div>
</div>
<div id="cell-fig-second-first-dist" class="cell" data-execution_count="8">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating the histogram.</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>plt.hist(data_with_2nd_dates[<span class="st">"1st-2nd-treatment_days"</span>], bins<span class="op">=</span><span class="dv">14</span>,  edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Histogram of Days Between 1st and 2nd Treatment"</span>)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Days between 1st and 2nd Treatment"</span>)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Frequency"</span>)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-second-first-dist" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-second-first-dist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="anicura_data_en_files/figure-html/fig-second-first-dist-output-1.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-second-first-dist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Histrogram of days between 1st and 2nd treatment
</figcaption>
</figure>
</div>
</div>
</div>
<p>Since the data quickly becomes fragmented, the number of days between the first and second therapy is divided into 4 groups:</p>
<ol type="1">
<li>less than 1 year – comparable,<br>
</li>
<li>from 1 to 1.5 years – good,<br>
</li>
<li>from 1.5 to 2 years – very good,<br>
</li>
<li>more than 2 years – excellent.<br>
</li>
</ol>
<p>From the histogram <a href="#fig-distribution-of-success" class="quarto-xref">Figure&nbsp;2</a>, it is evident that the most numerous group is “excellent.”<br>
In the table <a href="#tbl-mytable" class="quarto-xref">Table&nbsp;1</a>, you can find the treatments from the “comparable” group.<br>
</p>
<div id="cell-fig-distribution-of-success" class="cell" data-execution_count="9">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Kategorije glede na uspešnost</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co"># manj kot 1 leto – comparable,</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co"># od 1 do 1,5 leta – good,</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># od 1,5 do 2 leti – very good,</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co"># več kot 2 leti – excellent.</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="co"># data_with_2nd_dates.loc[data_with_2nd_dates["age_group"] == age_group, "1st-2nd-treatment_days"]</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>data_with_2nd_dates[<span class="st">"success_of_therapy"</span>]<span class="op">=</span><span class="st">"comparable"</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>data_with_2nd_dates.loc[data_with_2nd_dates[<span class="st">"1st-2nd-treatment_days"</span>]<span class="op">&gt;</span><span class="dv">360</span>, <span class="st">"success_of_therapy"</span>]<span class="op">=</span><span class="st">"good"</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>data_with_2nd_dates.loc[data_with_2nd_dates[<span class="st">"1st-2nd-treatment_days"</span>]<span class="op">&gt;</span><span class="dv">540</span>, <span class="st">"success_of_therapy"</span>]<span class="op">=</span><span class="st">"very good"</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>data_with_2nd_dates.loc[data_with_2nd_dates[<span class="st">"1st-2nd-treatment_days"</span>]<span class="op">&gt;</span><span class="dv">720</span>, <span class="st">"success_of_therapy"</span>]<span class="op">=</span><span class="st">"excellent"</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>sucess_groups <span class="op">=</span> [<span class="st">"comparable"</span>, <span class="st">"good"</span>, <span class="st">"very good"</span>, <span class="st">"excellent"</span>]</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>sns.countplot(data_with_2nd_dates, x<span class="op">=</span><span class="st">"success_of_therapy"</span>, order<span class="op">=</span>sucess_groups)</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-distribution-of-success" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-distribution-of-success-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="anicura_data_en_files/figure-html/fig-distribution-of-success-output-1.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-distribution-of-success-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Distribution of sucess groups.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-tbl-pos="H" data-execution_count="10">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> display</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>table_of_interest <span class="op">=</span> data_with_2nd_dates.loc[data_with_2nd_dates[<span class="st">"success_of_therapy"</span>]<span class="op">==</span><span class="st">"comparable"</span>,[<span class="st">"Sampling"</span>, <span class="st">"Diagnosis"</span>, <span class="st">"Number of joints treated"</span>, <span class="st">"Comments Feedback from owners"</span>,<span class="st">'follow up injections'</span>]]</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>pd.set_option(<span class="st">'display.max_colwidth'</span>, <span class="va">None</span>)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>display(table_of_interest)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="tbl-mytable" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-tbl-pos="H" data-execution_count="10">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-mytable-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Potek klasifikacije
</figcaption>
<div aria-describedby="tbl-mytable-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display">
<div>


<table class="dataframe do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Sampling</th>
<th data-quarto-table-cell-role="th">Diagnosis</th>
<th data-quarto-table-cell-role="th">Number of joints treated</th>
<th data-quarto-table-cell-role="th">Comments Feedback from owners</th>
<th data-quarto-table-cell-role="th">follow up injections</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">49</td>
<td>10.04.2019</td>
<td>Knee osteoarthritis</td>
<td>1.0</td>
<td>The 2nd stem cell therapy has once again been very successful, although we actually only wanted to maintain the "current state". He is not taking any painkillers and has a great zest for life again! Thank you very much for this great therapy!!! (feedback 29.06.2020)</td>
<td>2nd injection 11.03.2020 3rd injection: 30.06.2021, 1 knee\n4th injection: 05.07.2022, 5th injection: 04.07.2023; 1 knee, 1 hip</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">52</td>
<td>14.08.2019</td>
<td>Gonarthrosis on both sides ; Tarsal joint arthrosis</td>
<td>3.0</td>
<td>glecihbleibend, deceased</td>
<td>14.07.2020, 3 joints</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">56</td>
<td>27.11.2019</td>
<td>ED</td>
<td>1.0</td>
<td>Kiwi is doing very well, it is very rare to see a slight lameness. Mostly when he has been running across the fields at a stretched canter. But after a short rest he is fine again. Deceased</td>
<td>10.03.2020, 3joints</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">66</td>
<td>14.07.2020</td>
<td>Gonarthrosis on both sides ; OCD</td>
<td>1.0</td>
<td>unfortunately died of spleen tumor shortly after therapy, therefore not known if stem cells would have helped</td>
<td>2nd injection 17.02.2021, 1 joint, 12 million cells; 3rd: 6.4.2022, 2 joints; 4th: 13.4.2022, 2 joints</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">68</td>
<td>26.8.2020</td>
<td>Coxarthrosis bds hgr</td>
<td>2.0</td>
<td>no improvement deceased 2022</td>
<td>7.10.2020in both hips 4 mio Sz+ 2ml synochrome each</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">74</td>
<td>05.10.2020</td>
<td>Cubarthrosis bds</td>
<td>2.0</td>
<td>NaN</td>
<td>20.10.2021 2 joints</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">77</td>
<td>2021-01-12 00:00:00</td>
<td>bds HD + coxarthrosis</td>
<td>2.0</td>
<td>Toni is doing very well and is symptom-free</td>
<td>27.4.2021 in both arches yes 2mio sz</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">81</td>
<td>2021-01-20 00:00:00</td>
<td>Cubarthrosis on both sides</td>
<td>2.0</td>
<td>improvement</td>
<td>04.08.2021: 2x knees; 30.05.2023: 4 joints</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">82</td>
<td>2021-01-26 00:00:00</td>
<td>Coxarthrosis, gonarthrosis</td>
<td>2.0</td>
<td>PB does not know what helped stem cells or KBr on the same knee, improvement only after knee surgery</td>
<td>17.08.2021 right knee</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">103</td>
<td>2023-03-01 00:00:00</td>
<td>FCP Elbow right</td>
<td>2.0</td>
<td>this is already the 2nd dog of Mrs. Ververides for stem cells with you</td>
<td>18.04.2023: 1 joint</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</figure>
</div>
</div>
</section>
<section id="are-there-significant-patterns-in-time-intervals-regarding-the-age-of-patients" class="level3">
<h3 class="anchored" data-anchor-id="are-there-significant-patterns-in-time-intervals-regarding-the-age-of-patients">Are there significant patterns in time intervals regarding the age of patients?</h3>
<p>The distribution of age at the first application is shown in the image <a href="#fig-distribution-of-ages" class="quarto-xref">Figure&nbsp;3</a>. In the left column of graphs, we have all patients, while in the right column, we have only patients who received two treatments. From the first row of graphs, it can be observed that the distribution is skewed towards the right. Patients who received two treatments are somewhat younger. We divided the patients into four age groups:<br>
1. 0 to 2 years,<br>
2. 2 to 6 years,<br>
3. 6 to 10 years,<br>
4. more than 10 years.<br>
</p>
<div id="cell-fig-distribution-of-ages" class="cell" data-execution_count="11">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot age at first application</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">10</span>))  <span class="co"># Adjust figure size as needed</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>ordered_age_groups <span class="op">=</span> [<span class="st">"from 0 to 2"</span>, <span class="st">"from 2 to 6"</span>, <span class="st">"from 6 to 10"</span>, <span class="st">"more than 10"</span>]</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 1: Age at first application from data</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>sns.<span class="bu">set</span>(style<span class="op">=</span><span class="st">"darkgrid"</span>)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>sns.countplot(x<span class="op">=</span><span class="st">"age_at_first_appliction_str"</span>, data<span class="op">=</span>data, </span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>              order<span class="op">=</span>[<span class="bu">str</span>(age) <span class="cf">for</span> age <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">25</span>)], ax<span class="op">=</span>axes[<span class="dv">0</span>, <span class="dv">0</span>], stat<span class="op">=</span><span class="st">"probability"</span>)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">0</span>].set_title(<span class="st">"Age at First Application (All treatments)"</span>)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">0</span>].set_ylim(<span class="dv">0</span>, <span class="fl">0.20</span>)</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 2: Age group at first application from data</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>sns.countplot(x<span class="op">=</span><span class="st">"age_group"</span>, data<span class="op">=</span>data, </span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>              order<span class="op">=</span>ordered_age_groups, ax<span class="op">=</span>axes[<span class="dv">1</span>, <span class="dv">0</span>], stat<span class="op">=</span><span class="st">"probability"</span>)</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>, <span class="dv">0</span>].set_title(<span class="st">"Age Group at First Application (All treatments)"</span>)</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>, <span class="dv">0</span>].set_ylim(<span class="dv">0</span>, <span class="fl">0.55</span>)</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 3: Age at first application from data_with_2nd_dates</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>sns.countplot(x<span class="op">=</span><span class="st">"age_at_first_appliction_str"</span>, data<span class="op">=</span>data_with_2nd_dates, </span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>              order<span class="op">=</span>[<span class="bu">str</span>(age) <span class="cf">for</span> age <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">25</span>)], ax<span class="op">=</span>axes[<span class="dv">0</span>, <span class="dv">1</span>], stat<span class="op">=</span><span class="st">"probability"</span>)</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">1</span>].set_title(<span class="st">"Age at First Application (2 treatments)"</span>)</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">1</span>].set_ylim(<span class="dv">0</span>, <span class="fl">0.20</span>)</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 4: Age group at first application from data_with_2nd_dates</span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>sns.countplot(x<span class="op">=</span><span class="st">"age_group"</span>, data<span class="op">=</span>data_with_2nd_dates, </span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>              order<span class="op">=</span>ordered_age_groups, ax<span class="op">=</span>axes[<span class="dv">1</span>, <span class="dv">1</span>], stat<span class="op">=</span><span class="st">"probability"</span>)</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>, <span class="dv">1</span>].set_title(<span class="st">"Age Group at First Application (2 treatments)"</span>)</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>, <span class="dv">1</span>].set_ylim(<span class="dv">0</span>, <span class="fl">0.55</span>)</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjust layout</span></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-distribution-of-ages" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-distribution-of-ages-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="anicura_data_en_files/figure-html/fig-distribution-of-ages-output-1.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-distribution-of-ages-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Distribution of ages at first applicaiton
</figcaption>
</figure>
</div>
</div>
</div>
<div id="cell-fig-distribution-of-ages-days" class="cell" data-execution_count="12">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the bin edges manually, for example:</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>min_days <span class="op">=</span> data_with_2nd_dates[<span class="st">"1st-2nd-treatment_days"</span>].<span class="bu">min</span>()</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>max_days <span class="op">=</span> data_with_2nd_dates[<span class="st">"1st-2nd-treatment_days"</span>].<span class="bu">max</span>()</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>bins <span class="op">=</span> np.linspace(min_days, max_days, <span class="dv">15</span>)  <span class="co"># 14 bins</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a 2x2 grid of subplots</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">8</span>))  <span class="co"># 2 rows, 2 columns</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>axes <span class="op">=</span> axes.flatten()  <span class="co"># Flatten the 2D array of axes to iterate more easily</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through age groups and axes simultaneously</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, age_group <span class="kw">in</span> <span class="bu">enumerate</span>(ordered_age_groups):</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Filter the data for the specific age group</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>    plot_data <span class="op">=</span> data_with_2nd_dates.loc[data_with_2nd_dates[<span class="st">"age_group"</span>] <span class="op">==</span> age_group, <span class="st">"1st-2nd-treatment_days"</span>]</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate the mean and median</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>    mean_value <span class="op">=</span> plot_data.mean()</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>    median_value <span class="op">=</span> plot_data.median()</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>    ax <span class="op">=</span> axes[i]  <span class="co"># Select the correct subplot</span></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plot the histogram</span></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>    ax.hist(plot_data, bins<span class="op">=</span>bins, edgecolor<span class="op">=</span><span class="st">'black'</span>, density<span class="op">=</span><span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.9</span>, label<span class="op">=</span><span class="ss">f"Age Group: </span><span class="sc">{</span>age_group<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add vertical lines for mean and median</span></span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>    mean_line <span class="op">=</span> ax.axvline(mean_value, color<span class="op">=</span><span class="st">'blue'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, label<span class="op">=</span><span class="ss">f'Mean: </span><span class="sc">{</span>mean_value<span class="sc">:.1f}</span><span class="ss">'</span>)</span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>    median_line <span class="op">=</span> ax.axvline(median_value, color<span class="op">=</span><span class="st">'red'</span>, linestyle<span class="op">=</span><span class="st">'-'</span>, label<span class="op">=</span><span class="ss">f'Median: </span><span class="sc">{</span>median_value<span class="sc">:.1f}</span><span class="ss">'</span>)</span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Set titles and labelsdat</span></span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>    ax.set_ylim(<span class="dv">0</span>, <span class="fl">0.0020</span>)</span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>    ax.set_title(<span class="ss">f"Age Group: </span><span class="sc">{</span>age_group<span class="sc">}</span><span class="ss">, n=</span><span class="sc">{</span>plot_data<span class="sc">.</span>shape[<span class="dv">0</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>    ax.set_xlabel(<span class="st">"Days between 1st and 2nd Treatment"</span>)</span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>    ax.set_ylabel(<span class="st">"%"</span>)</span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add a legend that includes the mean and median lines</span></span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a>    ax.legend()</span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjust layout to prevent overlap</span></span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-distribution-of-ages-days" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-distribution-of-ages-days-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="anicura_data_en_files/figure-html/fig-distribution-of-ages-days-output-1.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-distribution-of-ages-days-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Distribution of days between first and second application relative to the age group of patients.
</figcaption>
</figure>
</div>
</div>
</div>
<div id="cell-fig-count-of-ages-success-sns" class="cell" data-execution_count="13">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>sns.countplot(data_with_2nd_dates, x<span class="op">=</span><span class="st">"success_of_therapy"</span>, hue<span class="op">=</span><span class="st">"age_group"</span>,order<span class="op">=</span>sucess_groups)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a 2x2 grid of subplots</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-count-of-ages-success-sns" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-count-of-ages-success-sns-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="anicura_data_en_files/figure-html/fig-count-of-ages-success-sns-output-1.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-count-of-ages-success-sns-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Counts of sucess groups relative to the age group of patients.
</figcaption>
</figure>
</div>
</div>
</div>
<div id="cell-fig-distribution-of-ages-success" class="cell" data-execution_count="14">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">8</span>))  <span class="co"># 2 rows, 2 columns</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>axes <span class="op">=</span> axes.flatten()  <span class="co"># Flatten the 2D array of axes to iterate more easily</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through age groups and axes simultaneously</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, age_group <span class="kw">in</span> <span class="bu">enumerate</span>(ordered_age_groups):</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Filter the data for the specific age group</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    plot_data <span class="op">=</span> data_with_2nd_dates.loc[data_with_2nd_dates[<span class="st">"age_group"</span>] <span class="op">==</span> age_group,]</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>    ax <span class="op">=</span> axes[i]  <span class="co"># Select the correct subplot</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plot the histogram</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>    sns.countplot(x<span class="op">=</span><span class="st">"success_of_therapy"</span>, data<span class="op">=</span>plot_data, </span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>              order<span class="op">=</span>sucess_groups, ax<span class="op">=</span>ax, stat<span class="op">=</span><span class="st">"probability"</span>)</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Set titles and labels</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>    ax.set_title(<span class="ss">f"Success of therapy age Group: </span><span class="sc">{</span>age_group<span class="sc">}</span><span class="ss">, n=</span><span class="sc">{</span>plot_data<span class="sc">.</span>shape[<span class="dv">0</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>    ax.set_xlabel(<span class="st">"Success group"</span>)</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>    ax.<span class="bu">set</span>(ylim<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>    ax.set_ylabel(<span class="st">"%"</span>)</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjust layout to prevent overlap</span></span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-distribution-of-ages-success" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-distribution-of-ages-success-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="anicura_data_en_files/figure-html/fig-distribution-of-ages-success-output-1.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-distribution-of-ages-success-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: Distribution of sucess groups relative to the age group of patients.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="are-there-significant-patterns-in-time-intervals-regarding-the-initial-severity-of-the-condition" class="level3">
<h3 class="anchored" data-anchor-id="are-there-significant-patterns-in-time-intervals-regarding-the-initial-severity-of-the-condition">Are there significant patterns in time intervals regarding the initial severity of the condition?</h3>
<p>Variable “Indication” is classified into 13 indication groups:<br>
1. OCD - Osteochondritis Disecans,<br>
2. OA - Osteoarthritis,<br>
3. Cubarthrosis,<br>
4. Omarthrosis,<br>
5. Gonarthrosis,<br>
6. Coxarthrosis,<br>
7. CCL - cranial cruciate ligament,<br>
8. FCP - Fragmented Coronoid Proces,<br>
9. HP - Hip dysplasia,<br>
11. ED - Elbow dysplasia,<br>
12. Arthritis,<br>
13. Other.<br>
</p>
<p>Some patients were assigned to multiple groups. Every patient with Gonarthrosis also has Osteoarthritis. We have more patients with Elbow dysplasia and Cubarthrosis.<br>
<br>
From the image <a href="#fig-distribution-of-indications" class="quarto-xref">Figure&nbsp;7</a>, it is evident that the highest number of patients has Osteoarthritis. We can also see that there are no significant differences in the distribution between patients who received one treatment or two treatments.</p>
<div id="cell-fig-distribution-of-indications" class="cell" data-execution_count="15">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>data_exploded <span class="op">=</span> data.explode(<span class="st">'Indication_list'</span>).reset_index()</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>data_with_2nd_dates_exploded <span class="op">=</span> data_with_2nd_dates.explode(<span class="st">'Indication_list'</span>).reset_index()</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot age at first application</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">10</span>))  <span class="co"># Adjust figure size as needed</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>ordered_indication_groups <span class="op">=</span> [<span class="st">"OCD"</span>, <span class="st">"OA"</span>, <span class="st">"Cubarthrosis"</span>, <span class="st">"Omarthrosis"</span>, <span class="st">"Gonarthrosis"</span>, <span class="st">"Coxarthrosis"</span>, <span class="st">"CCL"</span>, <span class="st">"FPC"</span>, <span class="st">"HD"</span>, <span class="st">"ED"</span>, <span class="st">"Arthritis"</span>, <span class="st">"Other"</span>]</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 1: Indication group from data</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>plot1 <span class="op">=</span> sns.countplot(x<span class="op">=</span><span class="st">"Indication_list"</span>, data<span class="op">=</span>data_exploded, </span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>                      order<span class="op">=</span>ordered_indication_groups, ax<span class="op">=</span>axes[<span class="dv">0</span>], stat<span class="op">=</span><span class="st">"probability"</span>)</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_title(<span class="st">"Indication at First Application (All treatments)"</span>)</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_ylim(<span class="dv">0</span>, <span class="fl">0.4</span>)</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_xticklabels(axes[<span class="dv">0</span>].get_xticklabels(), rotation<span class="op">=</span><span class="dv">45</span>, ha<span class="op">=</span><span class="st">"right"</span>)</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Add counts above each bar for Plot 1</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> p <span class="kw">in</span> plot1.patches:</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].annotate(<span class="ss">f'</span><span class="sc">{</span><span class="bu">int</span>(p.get_height() <span class="op">*</span> <span class="bu">len</span>(data_exploded))<span class="sc">}</span><span class="ss">'</span>,  <span class="co"># Calculate total counts</span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>                     (p.get_x() <span class="op">+</span> p.get_width() <span class="op">/</span> <span class="fl">2.</span>, p.get_height()), </span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>                     ha<span class="op">=</span><span class="st">'center'</span>, va<span class="op">=</span><span class="st">'baseline'</span>, fontsize<span class="op">=</span><span class="dv">10</span>, color<span class="op">=</span><span class="st">'black'</span>, xytext<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">3</span>), </span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>                     textcoords<span class="op">=</span><span class="st">'offset points'</span>)</span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 2: Age group at first application from data</span></span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>plot2 <span class="op">=</span> sns.countplot(x<span class="op">=</span><span class="st">"Indication_list"</span>, data<span class="op">=</span>data_with_2nd_dates_exploded, </span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>                      order<span class="op">=</span>ordered_indication_groups, ax<span class="op">=</span>axes[<span class="dv">1</span>], stat<span class="op">=</span><span class="st">"probability"</span>)</span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_title(<span class="st">"Indication at First Application (2 visits)"</span>)</span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_ylim(<span class="dv">0</span>, <span class="fl">0.4</span>)</span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_xticklabels(axes[<span class="dv">1</span>].get_xticklabels(), rotation<span class="op">=</span><span class="dv">45</span>, ha<span class="op">=</span><span class="st">"right"</span>)</span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> p <span class="kw">in</span> plot2.patches:</span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].annotate(<span class="ss">f'</span><span class="sc">{</span><span class="bu">int</span>(p.get_height() <span class="op">*</span> <span class="bu">len</span>(data_with_2nd_dates_exploded))<span class="sc">}</span><span class="ss">'</span>,  <span class="co"># Calculate total counts</span></span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>                     (p.get_x() <span class="op">+</span> p.get_width() <span class="op">/</span> <span class="fl">2.</span>, p.get_height()), </span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>                     ha<span class="op">=</span><span class="st">'center'</span>, va<span class="op">=</span><span class="st">'baseline'</span>, fontsize<span class="op">=</span><span class="dv">10</span>, color<span class="op">=</span><span class="st">'black'</span>, xytext<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">3</span>), </span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>                     textcoords<span class="op">=</span><span class="st">'offset points'</span>)</span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>C:\Users\justb\AppData\Local\Temp\ipykernel_26176\622326127.py:17: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
  axes[0].set_xticklabels(axes[0].get_xticklabels(), rotation=45, ha="right")
C:\Users\justb\AppData\Local\Temp\ipykernel_26176\622326127.py:31: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
  axes[1].set_xticklabels(axes[1].get_xticklabels(), rotation=45, ha="right")</code></pre>
</div>
<div class="cell-output cell-output-display">
<div id="fig-distribution-of-indications" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-distribution-of-indications-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="anicura_data_en_files/figure-html/fig-distribution-of-indications-output-2.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-distribution-of-indications-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7: Distribution of indications before first application
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="number-of-treated-joints" class="level2">
<h2 class="anchored" data-anchor-id="number-of-treated-joints">5. Number of treated joints:</h2>
<section id="how-many-joints-are-typically-treated-during-the-initial-therapy-and-how-many-are-treated-in-subsequent-therapies" class="level3">
<h3 class="anchored" data-anchor-id="how-many-joints-are-typically-treated-during-the-initial-therapy-and-how-many-are-treated-in-subsequent-therapies">How many joints are typically treated during the initial therapy, and how many are treated in subsequent therapies?</h3>
<div id="ab6502ca-bea4-4e71-8f4d-fcd408ffc524" class="cell" data-execution_count="16">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">### Counts of numbers of joints treated in first tratement</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="5ac92fa2-0c2b-4066-831b-c2deb47b1c6b" class="cell" data-execution_count="17">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>data[<span class="st">"Nr_joints treated_1_cleaned"</span>] <span class="op">=</span> data[<span class="st">"Nr_joints treated_1_cleaned"</span>].astype(<span class="bu">str</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>data[<span class="st">"Nr_joints treated_1_cleaned"</span>] <span class="op">=</span> data[<span class="st">"Nr_joints treated_1_cleaned"</span>].<span class="bu">str</span>.replace(<span class="st">"?"</span>, <span class="st">""</span>, regex<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>sns.<span class="bu">set</span>(style<span class="op">=</span><span class="st">"darkgrid"</span>)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> sns.countplot(x<span class="op">=</span><span class="st">"Nr_joints treated_1_cleaned"</span>, data<span class="op">=</span>data, order<span class="op">=</span> [<span class="st">"nan"</span>,<span class="st">"1"</span>, <span class="st">"2"</span>, <span class="st">"3"</span>, <span class="st">"4"</span>, <span class="st">"5"</span>, <span class="st">"6"</span>, <span class="st">"7"</span>, <span class="st">"8"</span>, <span class="st">"STORAGE"</span>,])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="anicura_data_en_files/figure-html/cell-18-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="counts-of-numbers-of-joints-treated-in-the-first-tratement.-only-treatments-where-also-second-treatment-happened" class="level3">
<h3 class="anchored" data-anchor-id="counts-of-numbers-of-joints-treated-in-the-first-tratement.-only-treatments-where-also-second-treatment-happened">Counts of numbers of joints treated in the first tratement. Only treatments where also second treatment happened</h3>
<div id="0b49bb16-2429-4ad2-8b5d-bd307937753b" class="cell" data-execution_count="18">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>modified<span class="op">=</span>data[<span class="op">~</span>data[<span class="st">"Nr_joints treated_2_cleaned"</span>].isnull()]</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>sns.<span class="bu">set</span>(style<span class="op">=</span><span class="st">"darkgrid"</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> sns.countplot(x<span class="op">=</span><span class="st">"Nr_joints treated_1_cleaned"</span>, data<span class="op">=</span>modified, order<span class="op">=</span>[<span class="st">"1"</span>, <span class="st">"2"</span>, <span class="st">"3"</span>, <span class="st">"4"</span>, <span class="st">"5"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="anicura_data_en_files/figure-html/cell-19-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="counts-of-numbers-of-joints-treated-in-the-second-tratement" class="level3">
<h3 class="anchored" data-anchor-id="counts-of-numbers-of-joints-treated-in-the-second-tratement">Counts of numbers of joints treated in the second tratement</h3>
<div id="10049c4e-c508-42b8-a77b-ab930b765408" class="cell" data-execution_count="19">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>sns.<span class="bu">set</span>(style<span class="op">=</span><span class="st">"darkgrid"</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> sns.countplot(x<span class="op">=</span><span class="st">"Nr_joints treated_2_cleaned"</span>, data<span class="op">=</span>data, order<span class="op">=</span> [<span class="st">"1"</span>, <span class="st">"2"</span>, <span class="st">"3"</span>, <span class="st">"4"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="anicura_data_en_files/figure-html/cell-20-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="8e84e783-22a8-4460-ae17-694adce5208f" class="cell" data-execution_count="20">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>data[<span class="st">"first_to_second_treatment"</span>] <span class="op">=</span> modified[<span class="st">"Nr_joints treated_1_cleaned"</span>]<span class="op">+</span> <span class="st">"-&gt;"</span> <span class="op">+</span> modified[<span class="st">"Nr_joints treated_2_cleaned"</span>].astype(<span class="bu">str</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>sns.<span class="bu">set</span>(style<span class="op">=</span><span class="st">"darkgrid"</span>)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> sns.countplot(x<span class="op">=</span><span class="st">"first_to_second_treatment"</span>, data<span class="op">=</span>data, order <span class="op">=</span> data[<span class="st">"first_to_second_treatment"</span>].value_counts().index)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>ax.tick_params(axis<span class="op">=</span><span class="st">'x'</span>, rotation<span class="op">=</span><span class="dv">45</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="anicura_data_en_files/figure-html/cell-21-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>